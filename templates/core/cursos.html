{% extends 'core/base.html' %}
{% load i18n static %}

{% block title %}
{% trans "Cursos A121 Revolution" %}
{% endblock %}

{% block extra_head %}
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<!-- Seção de Cursos -->
<section class="products" id="cursos">
    <div class="container">
        <h2>{% trans "Cursos do Futuro" %}</h2>
        <div class="product-grid">
            <div class="product-card">
                <div class="product-image-wrapper">
                    <img src="{% static 'images/ia-course.jpg' %}" alt="{% trans 'Introdução à IA' %}" class="product-image">
                </div>
                <h3>{% trans "Introdução à IA" %}</h3>
                <p>{% trans "Aprenda os fundamentos da inteligência artificial e aplique-a em seu dia a dia." %}</p>
                <p>{% trans "Preço" %}: <span class="product-price" data-price="199.90">199.90 €</span></p>
                <p>{% trans "Duração" %}: 10 {% trans "horas" %}</p>
                <a href="{% url 'core:cadastro' %}" class="btn">{% trans "Inscrever-se" %}</a>
            </div>
            <div class="product-card">
                <div class="product-image-wrapper">
                    <img src="{% static 'images/finance-course.jpg' %}" alt="{% trans 'Finanças Pessoais' %}" class="product-image">
                </div>
                <h3>{% trans "Finanças Pessoais" %}</h3>
                <p>{% trans "Domine suas finanças e planeje seu futuro com este curso prático." %}</p>
                <p>{% trans "Preço" %}: <span class="product-price" data-price="149.90">149.90 €</span></p>
                <p>{% trans "Duração" %}: 8 {% trans "horas" %}</p>
                <a href="{% url 'core:cadastro' %}" class="btn">{% trans "Inscrever-se" %}</a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% url 'javascript-catalog' %}"></script>
<script>
// Inicializar Partículas
particlesJS('particles-js', {
    particles: {
        number: { value: 100, density: { enable: true, value_area: 800 } },
        color: { value: '#00ffcc' },
        shape: { type: 'circle' },
        opacity: { value: 0.6, random: true },
        size: { value: 4, random: true },
        line_linked: { enable: true, distance: 150, color: '#00ffcc', opacity: 0.4, width: 1 },
        move: { enable: true, speed: 3, direction: 'none', random: false }
    },
    interactivity: {
        detect_on: 'canvas',
        events: { onhover: { enable: true, mode: 'repulse' }, onclick: { enable: true, mode: 'push' } },
        modes: { repulse: { distance: 120, duration: 0.4 }, push: { particles_nb: 4 } }
    },
    retina_detect: true
});

// Mudança de Idioma
document.getElementById('language-selector').addEventListener('change', function() {
    var selectedLanguage = this.value;
    var url = window.location.pathname;
    window.location.href = url + '?language=' + selectedLanguage;
});

// Mudança de Moeda com Taxa de Câmbio
document.getElementById('currency-selector').addEventListener('change', function() {
    var selectedCurrency = this.value;
    fetch('{% url "core:change_currency" %}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'X-CSRFToken': '{{ csrf_token }}'
        },
        body: 'currency=' + selectedCurrency
    }).then(response => response.json()).then(data => {
        if (data.success) {
            location.reload();
        }
    });
});

// Atualizar Preços com Taxa de Câmbio
function updatePrices(currency, rate) {
    document.querySelectorAll('.product-price').forEach(priceElement => {
        var basePrice = parseFloat(priceElement.getAttribute('data-price'));
        var convertedPrice = basePrice * rate;
        priceElement.textContent = convertedPrice.toFixed(2) + ' ' + currency;
    });
}

// Carregar Taxa de Câmbio
fetch('{% url "core:get_exchange_rate" %}?base=EUR')
    .then(response => response.json())
    .then(data => {
        var currency = document.getElementById('currency-selector').value;
        var rate = data.rates[currency] || 1;
        updatePrices(currency, rate);
    });
</script>
{% endblock %}